[TOC]

# RSA算法

* 一种非对称加密算法
* 使用公钥加密,私钥解密.公钥对外公开,私钥内部保存不公开

# 算法原理

加密公式:
$$
密文=明文^E\%N
$$

* 也就是明文的E次方然后取模N
* (E,N)组成公钥

解密公式:
$$
明文=密文^D\%N
$$

* 也就是密文的D次方然后取模N
* (D, N)组成私钥

E,D,N之间的关系:
$$
N=p_1*p_2 \\
Count = 小于N的素数数量 \\
E = 从 [1, Count]中随便取一个与Count互素的数
D和E的关系=> D*E\%Count=1
$$

>  n的长度就是密钥长度。3233写成二进制是110010100001，一共有12位，所以这个密钥就是12位。实际应用中，RSA密钥一般是1024位，重要场合则为2048位。

# 使用RSA

## 生成私钥和公钥

生成过程:

1. 使用rsa算法计算出私钥(E,N),公钥:(D,N)
2. 通过x509标准将得到的ras私钥转为PKCS格式
3. 将PKCS格式序列化为ASN.1 的 DER编码字符串
4. 最后,将生成的字符串保存为pem文件

openssl生成过程:

```shell
# 生成私钥
openssl genrsa -out private_.pem 1024
# 生成公钥
openssl rsa -in private_.pem -pubout -out public_.pem
```



## 加密

加密方式:

1. RSA-PSS: 填充模式对数据填充加密
2. RSA-OAEP: 对数据填充

通过随机填充,可以避免相同值碰撞,因为没有随机填充,那么相同的内容加密的结果会相同

# 明文长度

根据RSA算法计算规则:

* 明文加密后的输出长度和公钥的长度相同
* 如果使用填充模式的话,明文的长度小于`公钥长度-hash的大小*2 - 2`

比如公钥的长度为`2048`位,也就是`256`字节,如果使用`sha256`计算hash,长度为32字节,那么`明文的长度<=256-2*32-2=190`,明文最大长度为190字节